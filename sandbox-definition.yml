sandbox:
  name: malcolm-sandbox
  title: blue-team-with-malcolm
  description: Sandbox for blue team training with Malcolm SIEM
  topology: topology.yml
  
  variables:
    - name: ssh_public_key
      source: variables.yml

  lifecycle:
    on_create:
      - action: provision

    on_start:
      - action: run_on_host
        host: malcolm-host
        command: "/provisioning/malcolm/install-malcolm.sh"
        wait_for: 120
      - action: run_on_host
        host: malcolm-host
        command: "/provisioning/malcolm/start-malcolm.sh"
        wait_for: 240
      - action: run_on_host
        host: attacker-vm
        command: "/provisioning/attacker/run_attack.sh"
        wait_for: 10

  pools:
    - name: malcolm-pool
      description: "Pool for Malcolm sandboxes"
      instance_count: 1
      access: admins
